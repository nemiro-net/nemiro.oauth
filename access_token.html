<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp">
  <head>
    <link rel="SHORTCUT ICON" href="./../icons/favicon.ico" />
    <link rel="stylesheet" type="text/css" href="./../styles/branding.css" />
    <link rel="stylesheet" type="text/css" href="./../styles/branding-en-US.css" />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Access token</title>
    <meta name="Language" content="en-us" />
  <link type='text/css' rel='stylesheet' href='styles/highlight.css' /><script type='text/javascript' src='scripts/highlight_ac.js'></script></head>
  <body class="primary-mtps-offline-document">
    <div class="OH_outerDiv">
      <div class="OH_outerContent">
        <div id="mainSection">
          <div id="mainBody">
            <h1>Access token</h1>
            <p>The access token is required to work with API.</p>
            <p>Access token you can found in the property <b>AccessTokenValue</b> of the <b>AuthorizationResult</b>.</p>
            <p>For example:</p>
            <div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img src="icons/CopyCode.gif" style="margin-right: 5px;" />Copy</span>C#</div><pre class="highlight-pre"><span class="highlight-spacerShort"></span><span class="highlight-keyword">var</span> result = OAuthWeb.VerifyAuthorization(<span class="highlight-literal">&quot;result url&quot;</span>);
<span class="highlight-spacerShort"></span><span class="highlight-keyword">if</span> (result.IsSuccessfully)
<span class="highlight-spacerShort"></span>{
<span class="highlight-spacerShort"></span>  <span class="highlight-comment">// ..successfully.. </span>
<span class="highlight-spacerShort"></span>  Console.WriteLine(<span class="highlight-literal">&quot;Access token is: {0}&quot;</span>, result.AccessTokenValue);
<span class="highlight-spacerShort"></span>}</pre>
            <div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img src="icons/CopyCode.gif" style="margin-right: 5px;" />Copy</span>VB</div><pre class="highlight-pre"><span class="highlight-spacerShort"></span><span class="highlight-keyword">Dim</span> result <span class="highlight-keyword">As</span> AuthorizationResult = OAuthWeb.VerifyAuthorization(<span class="highlight-literal">&quot;result url&quot;</span>)
<span class="highlight-spacerShort"></span><span class="highlight-keyword">If</span> result.IsSuccessfully <span class="highlight-keyword">Then</span> 
<span class="highlight-spacerShort"></span>  <span class="highlight-comment">&#39; ..successfully..</span>
<span class="highlight-spacerShort"></span>  Console.WriteLine(<span class="highlight-literal">&quot;Access token is: {0}&quot;</span>, result.AccessTokenValue)
<span class="highlight-spacerShort"></span><span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span></pre>

            <p>In the library is implemented request of the user data via the API provider. You can see it in your code (<b>GetUserInfo</b> method of the clients class).</p>
            <p>If you need to work with other methods of the API provider, then you need to request for permission, prior to receipt of the access token. Use the <b>Scope</b> property for this.</p>
            <p>For example:</p>
            <div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img src="icons/CopyCode.gif" style="margin-right: 5px;" />Copy</span>C#</div><pre class="highlight-pre"><span class="highlight-spacerShort"></span>OAuthManager.RegisterClient
<span class="highlight-spacerShort"></span>(
<span class="highlight-spacerShort"></span>  <span class="highlight-keyword">new</span> FacebookClient
<span class="highlight-spacerShort"></span>  (
<span class="highlight-spacerShort"></span>    <span class="highlight-literal">&quot;1435890426686808&quot;</span>,
<span class="highlight-spacerShort"></span>    <span class="highlight-literal">&quot;c6057dfae399beee9e8dc46a4182e8fd&quot;</span>
<span class="highlight-spacerShort"></span>  )
<span class="highlight-spacerShort"></span>  { 
<span class="highlight-spacerShort"></span>    Scope = <span class="highlight-literal">&quot;public_profile,email,user_friends&quot;</span>
<span class="highlight-spacerShort"></span>  }
<span class="highlight-spacerShort"></span>);</pre>
            <div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img src="icons/CopyCode.gif" style="margin-right: 5px;" />Copy</span>VB</div><pre class="highlight-pre"><span class="highlight-spacerShort"></span>OAuthManager.RegisterClient _
<span class="highlight-spacerShort"></span>(
<span class="highlight-spacerShort"></span>  <span class="highlight-keyword">New</span> FacebookClient _
<span class="highlight-spacerShort"></span>  (
<span class="highlight-spacerShort"></span>    <span class="highlight-literal">&quot;1435890426686808&quot;</span>,
<span class="highlight-spacerShort"></span>    <span class="highlight-literal">&quot;c6057dfae399beee9e8dc46a4182e8fd&quot;</span>
<span class="highlight-spacerShort"></span>  ) <span class="highlight-keyword">With</span> _
<span class="highlight-spacerShort"></span>  { 
<span class="highlight-spacerShort"></span>    .Scope = <span class="highlight-literal">&quot;public_profile,email,user_friends&quot;</span>
<span class="highlight-spacerShort"></span>  }
<span class="highlight-spacerShort"></span>)</pre>
            <p><b>NOTE:</b> When you change the <b>Scope</b> properties do not forget to request the permissions to obtain information from the user profile.</p>
            <p>Information about the permissions you can find the documentation on the providers website.</p>
            <p>You can use <b>Nemiro.OAuth.Helpers.ExecuteRequest</b> method for requests to API.</p>
            <p>For example:</p>
            <div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img src="icons/CopyCode.gif" style="margin-right: 5px;" />Copy</span>C#</div><pre class="highlight-pre"><span class="highlight-spacerShort"></span><span class="highlight-comment">// get user friends</span>
<span class="highlight-spacerShort"></span><span class="highlight-comment">// query parameters</span>
<span class="highlight-spacerShort"></span><span class="highlight-keyword">var</span> parameters = <span class="highlight-keyword">new</span> NameValueCollection
<span class="highlight-spacerShort"></span>{ 
<span class="highlight-spacerShort"></span>  { <span class="highlight-literal">&quot;access_token&quot;</span>, accessToken },
<span class="highlight-spacerShort"></span>  { <span class="highlight-literal">&quot;count&quot;</span>, <span class="highlight-literal">&quot;10&quot;</span> }, <span class="highlight-comment">// first 10 friends</span>
<span class="highlight-spacerShort"></span>  { <span class="highlight-literal">&quot;fields&quot;</span>, <span class="highlight-literal">&quot;nickname&quot;</span> }
<span class="highlight-spacerShort"></span>};
<span class="highlight-spacerShort"></span>
<span class="highlight-spacerShort"></span><span class="highlight-comment">// execute the request</span>
<span class="highlight-spacerShort"></span><span class="highlight-keyword">var</span> result = Nemiro.OAuth.Helpers.ExecuteRequest
<span class="highlight-spacerShort"></span>(
<span class="highlight-spacerShort"></span>  <span class="highlight-literal">&quot;GET&quot;</span>,
<span class="highlight-spacerShort"></span>  <span class="highlight-literal">&quot;https://api.vk.com/method/friends.get&quot;</span>,
<span class="highlight-spacerShort"></span>  parameters,
<span class="highlight-spacerShort"></span>  <span class="highlight-keyword">null</span>
<span class="highlight-spacerShort"></span>);
<span class="highlight-spacerShort"></span>
<span class="highlight-spacerShort"></span><span class="highlight-keyword">foreach</span> (Dictionary&lt;<span class="highlight-keyword">string</span>, <span class="highlight-keyword">object</span>&gt; itm <span class="highlight-keyword">in</span> (Array)result[<span class="highlight-literal">&quot;response&quot;</span>])
<span class="highlight-spacerShort"></span>{
<span class="highlight-spacerShort"></span>  <span class="highlight-keyword">string</span> friendName = <span class="highlight-literal">&quot;&quot;</span>;
<span class="highlight-spacerShort"></span>  <span class="highlight-keyword">if</span> (itm.ContainsKey(<span class="highlight-literal">&quot;first_name&quot;</span>) &amp;&amp; itm.ContainsKey(<span class="highlight-literal">&quot;last_name&quot;</span>))
<span class="highlight-spacerShort"></span>  {
<span class="highlight-spacerShort"></span>    friendName = String.Format(<span class="highlight-literal">&quot;{0} {1}&quot;</span>, itm[<span class="highlight-literal">&quot;first_name&quot;</span>], itm[<span class="highlight-literal">&quot;last_name&quot;</span>]);
<span class="highlight-spacerShort"></span>  }
<span class="highlight-spacerShort"></span>  <span class="highlight-keyword">else</span>
<span class="highlight-spacerShort"></span>  {
<span class="highlight-spacerShort"></span>    friendName = itm[<span class="highlight-literal">&quot;nickname&quot;</span>].ToString();
<span class="highlight-spacerShort"></span>  }
<span class="highlight-spacerShort"></span>  Console.WriteLine(friendName);
<span class="highlight-spacerShort"></span>}</pre>
            <div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img src="icons/CopyCode.gif" style="margin-right: 5px;" />Copy</span>VB</div><pre class="highlight-pre"><span class="highlight-spacerShort"></span><span class="highlight-comment">&#39; get user friends</span>
<span class="highlight-spacerShort"></span><span class="highlight-comment">&#39; query parameters</span>
<span class="highlight-spacerShort"></span><span class="highlight-keyword">Dim</span> parameters <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> NameValueCollection() From _
<span class="highlight-spacerShort"></span>{ 
<span class="highlight-spacerShort"></span>  { <span class="highlight-literal">&quot;access_token&quot;</span>, accessToken },
<span class="highlight-spacerShort"></span>  { <span class="highlight-literal">&quot;count&quot;</span>, <span class="highlight-literal">&quot;10&quot;</span> },
<span class="highlight-spacerShort"></span>  { <span class="highlight-literal">&quot;fields&quot;</span>, <span class="highlight-literal">&quot;nickname&quot;</span> }
<span class="highlight-spacerShort"></span>}
<span class="highlight-spacerShort"></span>
<span class="highlight-spacerShort"></span><span class="highlight-comment">&#39; execute the request</span>
<span class="highlight-spacerShort"></span><span class="highlight-keyword">Dim</span> result <span class="highlight-keyword">As</span> RequestResult = Helpers.ExecuteRequest _
<span class="highlight-spacerShort"></span>(
<span class="highlight-spacerShort"></span>  <span class="highlight-literal">&quot;GET&quot;</span>,
<span class="highlight-spacerShort"></span>  <span class="highlight-literal">&quot;https://api.vk.com/method/friends.get&quot;</span>,
<span class="highlight-spacerShort"></span>  parameters,
<span class="highlight-spacerShort"></span>  <span class="highlight-keyword">Nothing</span>
<span class="highlight-spacerShort"></span>)
<span class="highlight-spacerShort"></span>
<span class="highlight-spacerShort"></span><span class="highlight-keyword">For</span> <span class="highlight-keyword">Each</span> itm <span class="highlight-keyword">As</span> Dictionary(<span class="highlight-keyword">Of</span> <span class="highlight-keyword">String</span>, <span class="highlight-keyword">Object</span>) <span class="highlight-keyword">In</span> <span class="highlight-keyword">CType</span>(result(<span class="highlight-literal">&quot;response&quot;</span>), Array)
<span class="highlight-spacerShort"></span>  <span class="highlight-keyword">Dim</span> friendName <span class="highlight-keyword">As</span> <span class="highlight-keyword">String</span> = <span class="highlight-literal">&quot;&quot;</span>
<span class="highlight-spacerShort"></span>  <span class="highlight-keyword">If</span> itm.ContainsKey(<span class="highlight-literal">&quot;first_name&quot;</span>) <span class="highlight-keyword">AndAlso</span> itm.ContainsKey(<span class="highlight-literal">&quot;last_name&quot;</span>) <span class="highlight-keyword">Then</span>
<span class="highlight-spacerShort"></span>    friendName = <span class="highlight-keyword">String</span>.Format(<span class="highlight-literal">&quot;{0} {1}&quot;</span>, itm(<span class="highlight-literal">&quot;first_name&quot;</span>), itm(<span class="highlight-literal">&quot;last_name&quot;</span>))
<span class="highlight-spacerShort"></span>  <span class="highlight-keyword">Else</span>
<span class="highlight-spacerShort"></span>    friendName = itm(<span class="highlight-literal">&quot;nickname&quot;</span>).ToString()
<span class="highlight-spacerShort"></span>  <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>
<span class="highlight-spacerShort"></span>  Console.WriteLine(friendName)
<span class="highlight-spacerShort"></span><span class="highlight-keyword">Next</span></pre>
            <p>
              <b>NOTE:</b> Please, do not add the code to work with the API to the library. 
              Creat for API individual projects. 
              The <b>Nemiro.OAuth</b> library is intended for exclusive OAuth (not for providers API).
            </p>
            <h2>See Also</h2>
            <p><a href="/scope.html">Scope</a><br /><a href="/parameters.html">Parameters</a></p>
          </div>
        </div>
      </div>
    </div>
    <div id="OH_footer" class="OH_footer"><p><a href="http://oauth.nemiro.net" target="_top">Copyright © Aleksey Nemiro, 2014</a></p></div>
  </body>
</html>